var iPad=navigator.userAgent.match(/(iPad)/)||navigator.platform==="MacIntel"&&navigator.maxTouchPoints>1;var isShield=$.browser.ie||iPad||$.browser.safari;if(isShield){$(".s-manhattan-index").removeClass("open-homepage-tts");$(".s-set-homepage-tts").remove()}if(s_session.isLogin&&!isShield){$("#homepage_tts_player").remove();$("#head").append('<div id="homepage_tts_player"></div>');var baseUrl="https://mbd.baidu.com";var apis={getVoiceListApi:baseUrl+"/newspage/api/getpcvoicelist",
editVoiceListApi:baseUrl+"/newspage/api/updateuservoice",requestUrl:baseUrl+"/newspage/api/getttsurllist"};var lastMetaItemOffset=$(".news-meta-item:last").offset();var nLeft=parseInt(lastMetaItemOffset?lastMetaItemOffset.left:"0",10)+"px";require(["@baidu/pc-tts-player"],function(_player){player=new _player.TtsPlayer({uiOptions:{rootSelector:"#homepage_tts_player",bottom:"48px",left:nLeft,smallWidth:1340},coreOptions:{getVoiceListApi:apis.getVoiceListApi,editVoiceListApi:apis.editVoiceListApi},
logOptions:{logFrom:"feed_index",clickTid:"11546",showTid:"11545",durationTid:"11549",sid:s_session.sid}});initHomepageTts(player)})}function initHomepageTts(player){var opt={};opt.baseParams={ct:2,qid:s_session.seqId,sid:s_session.sid,ssid:s_session.portrait,logid:s_session.logId||"0",_r:Math.random()};var thunder=window.Thunder.get(opt);var thunderlogShow={tid:11545,logFrom:"feed_index",logInfo:"tts_show",logExtra:{type:"tts_button_show"}};var thunderlogClick={tid:11546,logFrom:"feed_index",
logInfo:"tts_click",logExtra:{type:"tts_button_click",value:""}};var _topDom=$("#s_xmancard_news_new");var nidsArr=[];var idList=[];function addNidToPlayerList(ele,nidsArr,idList,logTypeList){var $ele=$(ele);var nid=$ele.attr("data-nid");if(nid){var subject=$ele.attr("data-subject");var type=$ele.attr("data-type");var requestParams={nids:[nid],subjectMap:{}};if(logTypeList&&logTypeList.hasOwnProperty("length")){logTypeList.push(type)}switch(type){case"topic":requestParams.subjectMap[nid]=subject
;break;default:break}requestParams.subjectMap=JSON.stringify(requestParams.subjectMap);nidsArr.push({id:nid,requestUrl:apis.requestUrl,requestParams:requestParams,logParams:{res:type}});idList.push(nid)}}_topDom.find(".s-news-list-wrapper .s-news-special .has-tts").each(function(){addNidToPlayerList(this,nidsArr,idList)});player.addItems(nidsArr);var newsItemLen=idList.length;var lastItemLen=0;$(".water-container").on("DOMSubtreeModified",function(e){nidsArr=[];idList=[];var logTypeList=[]
;_topDom.find(".s-news-list-wrapper .s-news-special .has-tts").each(function(){addNidToPlayerList(this,nidsArr,idList,logTypeList)});player.updateItems(nidsArr);newsItemLen=idList.length;var diff=newsItemLen-lastItemLen;if($(".s-manhattan-index").hasClass("open-homepage-tts")){for(var i=lastItemLen;i<lastItemLen+diff;i++){var thunderlog=$.extend(true,{},thunderlogShow);thunderlog.logExtra.res=logTypeList[i];thunderlog.logExtra=$.stringify(thunderlog.logExtra);thunder.send(thunderlog)}}
lastItemLen=newsItemLen});$(".water-container").on("DOMNodeRemoved",function(e){var target=e.target;if(target.classList&&target.classList.toString().indexOf("has-tts")!==-1){var delNid=target.attributes.getNamedItem("data-nid");if(idList.indexOf(delNid)!==-1){if(player.core.curPlayItem){var curNid=player.core.curPlayItem.id;var curIndex=idList.indexOf(curNid)}idList.splice(idList.indexOf(delNid),1);var resNidsArr=nidsArr.filter(function(value){return idList.indexOf(value.id)!==-1})
;player.updateItems(resNidsArr);if(player.core.curPlayItem&&idList[curIndex]!==curNid){if(idList[curIndex]){player.playItem(idList[curIndex])}}}}});$(document).ajaxComplete(function(){if($("#head_wrapper").hasClass("s-ps-islite")){player.hide();player.pause()}});player.render();player.hide();var playTtsClicked="";_topDom.delegate(".play-tts","click",function(e){var nid=$(this).attr("data-nid");if(player.core.curPlayItem&&nid===player.core.curPlayItem.id){player["continue"]()}else{
player.playItem(nid);playTtsClicked=nid}playUI(this);var curElementTitle=".s-news-item-title[data-nid="+nid+"]";var $curElementTitle=$(curElementTitle);var type=$curElementTitle.attr("data-type");$curElementTitle.addClass("news-reading");var thunderlog=$.extend(true,{},thunderlogClick);thunderlog.logExtra.value="play";thunderlog.logExtra.res=type;thunderlog.logExtra=$.stringify(thunderlog.logExtra);thunder.send(thunderlog);$(window).trigger("aging-tools.close");e.stopPropagation()}).delegate(
".pause-tts","click",function(e){player.pause();pauseUI(this);var nid=$(this).attr("data-nid");var curElementTitle=".s-news-item-title[data-nid="+nid+"]";var $curElementTitle=$(curElementTitle);var type=$curElementTitle.attr("data-type");$curElementTitle.removeClass("news-reading").addClass("news-readed");var thunderlog=$.extend(true,{},thunderlogClick);thunderlog.logExtra.value="pause";thunderlog.logExtra.res=type;thunderlog.logExtra=$.stringify(thunderlog.logExtra);thunder.send(thunderlog)
;e.stopPropagation()}).delegate(".s-news-item-title","click",function(e){if($(this).hasClass("has-tts")){$(this).addClass("news-readed")}e.stopPropagation()}).delegate(".c-img","click",function(e){if($(this).parents(".s-news-special").hasClass("has-tts")){var nid="news_"+$(this).parents(".s-news-special").attr("data-rid");var curElementTitle=".s-news-item-title[data-nid="+nid+"]";$(curElementTitle).addClass("news-readed")}e.stopPropagation()});$("#s-user-setting-menu .set-close-homepage-tts"
).click(function(){player.hide()});player.init().then(function(){player.events.on("startPlay",function(data){var nid=data.curPlayItem.id;newsItemLen=idList.length;if(idList[newsItemLen-1]===nid){F.use("superman:skeleton/presenter",function(presenter){presenter.init();presenter.judgeFire()})}var curElement=".play-tts[data-nid="+nid+"]";playUI(curElement);var curElementTitle=".s-news-item-title[data-nid="+nid+"]";$(curElementTitle).addClass("news-reading");if(data.lastPlayItem){
var lastElementTitle=".s-news-item-title[data-nid="+data.lastPlayItem.id+"]";$(lastElementTitle).removeClass("news-reading").addClass("news-readed");var lastIndex=idList.indexOf(data.lastPlayItem.id)}var curIndex=idList.indexOf(nid);if($(curElementTitle).hasClass("news-readed")&&lastIndex<curIndex&&playTtsClicked!==nid){var nextIndex=curIndex++;var nextNid=idList[nextIndex];var nextElementTitle=".s-news-item-title[data-nid="+nextNid+"]";while($(nextElementTitle).hasClass("news-readed")){
nextIndex=curIndex++;nextNid=idList[nextIndex];nextElementTitle=".s-news-item-title[data-nid="+nextNid+"]"}if(idList[nextIndex]){player.playItem(idList[nextIndex])}}$(window).trigger("aging-tools.close")});player.events.on("pause",function(data){var nid=data.id;var curElement=".pause-tts[data-nid="+nid+"]";pauseUI(curElement);var curElementTitle=".s-news-item-title[data-nid="+nid+"]";if($(curElementTitle).hasClass("news-reading")){$(curElementTitle).removeClass("news-reading").addClass(
"news-readed")}});player.events.on("play",function(data){var nid=data.id;var curElement=".play-tts[data-nid="+nid+"]";playUI(curElement);var curElementTitle=".s-news-item-title[data-nid="+nid+"]";$(curElementTitle).addClass("news-reading");$(window).trigger("aging-tools.close")});player.events.on("clickTitle",function(data){var nid=data.id;var curElement=".play-tts[data-nid="+nid+"]";var url=$(curElement).parents(".s-news-item").attr("data-url");window.open(url,"_blank")})});function debounce(fn
,delay){var timer;return function(){var _this=this;var args=arguments;if(timer){clearTimeout(timer)}timer=setTimeout(function(){fn.apply(_this,args)},delay)}}function resizeForPlayer(){var nLeft=parseInt($(".news-meta-item:last").offset().left,10)+"px";player.editPosition({left:nLeft})}function scrollForPlayer(){var nLeft=parseInt($(".news-meta-item:last").offset().left-$(window).scrollLeft(),10)+"px";player.editPosition({left:nLeft})}var resizeDebounce=debounce(resizeForPlayer,100)
;var scrollDebounce=debounce(scrollForPlayer,100);$(window).on("resize",resizeDebounce);$(window).on("scroll",scrollDebounce);$(window).on("index_off",function(){player.hide()});$(window).on("tts.close",function(){player.hide()});$(window).on("switchCard",function(){player.hide()})}function playUI(curElement){$(".play-tts").css({display:"block"});$(curElement).css({display:"none"});$(".pause-tts").css({display:"none"});$(curElement).next().css({display:"block"})}function pauseUI(curElement){$(
curElement).css({display:"none"});$(curElement).prev().css({display:"block"})}
F.module("superman:news/card_alsLog",function(require,exports,ctx){function imgLog(src){var n="imglog__"+(new Date).getTime();var c=window[n]=new Image;c.onload=c.onerror=function(){window[n]=null};c.src=src;c=null}var ALSLOG_TYPE={CLICK:2,SHOW:3};function AlsLog(){this.init()}AlsLog.prototype={constructor:AlsLog,init:function(){this.alsHostHttp="http://als.baidu.com/clog/clog";this.alsHostHttps="https://als.baidu.com/clog/clog";var productId=39;var clientType=0;var baiduId=$.cookie.get(
"BAIDUID");this.alsCommonFields=this.buildAlsParams(productId,clientType,baiduId)},buildAlsParams:function(productId,clientType,baiduId){return{productId:productId,_client_type:clientType,baiduId:baiduId}},sendAls:function(data){var paramList=[];for(var key in data){paramList.push([encodeURIComponent(key),"=",encodeURIComponent(data[key])].join(""))}imgLog(this.alsHostHttps+"?"+paramList.join("&"))},buildAlsLogData:function(logContent,adContent){var ad=encodeURIComponent($.stringify([$.extend({
da_page:"index",da_page_num:1,da_locate:1,origin_time:+new Date},adContent)]));return $.extend({},this.alsCommonFields,logContent,{ad:ad})},sendAlsClickLog:function(logContent,adContent){this.sendAls(this.buildAlsLogData(logContent,$.extend(adContent,{da_type:ALSLOG_TYPE.CLICK})));return this},sendAlsShowLog:function(logContent,adContent){this.sendAls(this.buildAlsLogData(logContent,$.extend(adContent,{da_type:ALSLOG_TYPE.SHOW})));return this}};return new AlsLog});
F.module("superman:news/ck",function(require,exports,tool){var RE_IS_PS_LINK=/link\?url\=([^\&]+)/;var RE_IS_RCV_LINK=/\?url\=([^\.]+)\./;var ck={};ck.nativeadStorageMap={};function getNativeadStorage(id){if(!ck.nativeadStorageMap[id]){ck.nativeadStorageMap[id]={firstOverCoordinateX:undefined,firstOverCoordinateY:undefined,mousedownX:0,mousedownY:0,mouseoverTimes:0,latestMouseoverTime:0,latestMousedownTime:0,latestMouseupTime:0,diffMousedownAndMouseoverTime:0,diffMouseupAndMousedownTime:0}}
return ck.nativeadStorageMap[id]}function findParentAnchorNode(currentAnchor){while(currentAnchor&&currentAnchor.tagName!=="A"){currentAnchor=currentAnchor.parentNode}return currentAnchor}function needAddCk(currentAnchor){var url=currentAnchor.href;var matched=RE_IS_PS_LINK.exec(url)||RE_IS_RCV_LINK.exec(url);return matched?matched[1]:false}function updateCk(timesign,id,currentAnchor){var iDomain=needAddCk(currentAnchor);if(iDomain!==false){var checksum=computeChecksum(iDomain,timesign,id)
;appendCkInfo(checksum,id,currentAnchor)}}function appendCkInfo(checksum,id,currentAnchor){var nativeadStorage=getNativeadStorage(id);var ck="&ck="+[checksum,nativeadStorage.mouseoverTimes,nativeadStorage.diffMouseupAndMousedownTime,nativeadStorage.mousedownX,nativeadStorage.mousedownY,nativeadStorage.firstOverCoordinateX,nativeadStorage.firstOverCoordinateY,nativeadStorage.diffMousedownAndMouseoverTime].join(".");if(currentAnchor.href){var url=currentAnchor.href;if(url.indexOf("&ck=")===-1){
currentAnchor.href+=ck}else{currentAnchor.href=url.replace(/&ck=[\d.]*/,ck)}}}function computeChecksum(iDomain,timesign,id){var checksum=0;var nativeadStorage=getNativeadStorage(id);for(var x=0;x<nativeadStorage.mouseoverTimes*timesign%99+9;x++){var iDomainLen=iDomain.length<20?iDomain.length:20;checksum+=iDomain.charCodeAt(nativeadStorage.diffMouseupAndMousedownTime*x%iDomain.length)}return checksum}function saveMouseoverInfo(event,id){event=event||window.event
;var nativeadStorage=getNativeadStorage(id);nativeadStorage.mouseoverTimes++;if(nativeadStorage.firstOverCoordinateX===undefined){nativeadStorage.firstOverCoordinateX=event.clientX}if(nativeadStorage.firstOverCoordinateY===undefined){nativeadStorage.firstOverCoordinateY=event.clientY}nativeadStorage.latestMouseoverTime=(new Date).getTime()}function saveMousedownInfo(event,timesign,id){event=event||window.event;var nativeadStorage=getNativeadStorage(id)
;var currentAnchor=event.target||event.srcElement;currentAnchor=findParentAnchorNode(currentAnchor);nativeadStorage.latestMousedownTime=(new Date).getTime();nativeadStorage.diffMouseupAndMousedownTime=9999;nativeadStorage.mousedownX=event.clientX;nativeadStorage.mousedownY=event.clientY;if(nativeadStorage.latestMouseoverTime===0){nativeadStorage.diffMousedownAndMouseoverTime=0}else{
nativeadStorage.diffMousedownAndMouseoverTime=nativeadStorage.latestMousedownTime-nativeadStorage.latestMouseoverTime}updateCk(timesign,id,currentAnchor)}function saveMouseupInfo(event,timesign,id){event=event||window.event;var nativeadStorage=getNativeadStorage(id);var currentAnchor=event.target||event.srcElement;currentAnchor=findParentAnchorNode(currentAnchor);nativeadStorage.latestMouseupTime=(new Date).getTime()
;nativeadStorage.diffMouseupAndMousedownTime=nativeadStorage.latestMouseupTime-nativeadStorage.latestMousedownTime;updateCk(timesign,id,currentAnchor)}return{saveMouseoverInfo:saveMouseoverInfo,saveMousedownInfo:saveMousedownInfo,saveMouseupInfo:saveMouseupInfo}});
F.module("superman:news/index_view",function(require,exports,tool){function View(topDom){var _ctx=this;_ctx.perCount=10;_ctx.passNum=10;_ctx.curRound=1;_ctx.topDom=topDom;_ctx.ranDom=$(".s-news-rank-content",_ctx.topDom);_ctx.curImgNum=0;_ctx.hotWrap=$(".new-image-pool");_ctx.hotCtrlNum=$(".carousel-ctrl-item",_ctx.topDom).length;_ctx.hotCtrlWid=$(".new-image-pool .img-item",_ctx.topDom).width();_ctx.ctrlWrap=$(".carousel-ctrl")}View.prototype={flashImg:function($img,type){var _ctx=this;if(
!_ctx.imgRef){_ctx.imgRef=$(".s-news-img",_ctx.topDom).eq(0);_ctx.imgHeight=_ctx.imgRef.height();_ctx.imgWidth=_ctx.imgRef.width()}if(type==="mouseenter"){$(".s-news-img:animated").stop().css({"margin-top":"0","margin-left":"0",width:_ctx.imgWidth,height:_ctx.imgHeight});$img.animate({"margin-top":"-10px","margin-left":"-10px",width:_ctx.imgWidth+20,height:_ctx.imgHeight+20})}else{$img.animate({"margin-top":"0","margin-left":"0",width:_ctx.imgWidth,height:_ctx.imgHeight})}},
switchHotImg:function(cNum,add,force){var _ctx=this;if(_ctx.stopSwitch&&!force){return}if(!!add){var fix=parseInt(_ctx.curImgNum,10)+cNum;fix=fix<0?fix+_ctx.hotCtrlNum:fix;_ctx.curImgNum=fix%_ctx.hotCtrlNum}else if(cNum){_ctx.curImgNum=cNum}else{_ctx.curImgNum=(parseInt(_ctx.curImgNum,10)+1)%_ctx.hotCtrlNum}clearTimeout(_ctx.cTimmer);_ctx.ctrlWrap.find(".carousel-ctrl-cur").removeClass("carousel-ctrl-cur").end().find('[data-index="'+_ctx.curImgNum+'"]').addClass("carousel-ctrl-cur")
;_ctx.hotWrap.stop().animate({left:-1*_ctx.curImgNum*_ctx.hotCtrlWid+"px"},function(){_ctx.carousel()})},carousel:function(){var _ctx=this;_ctx.cTimmer=setInterval(function(){_ctx.switchHotImg(1,true)},5e3)},createRecom:function(newsItem,callback){_ctx=this;$.ajaxpost(s_domain.baseuri+"/news/data/newrelatewords",{title:$.trim($(newsItem).find("h2 .s-yahei").text()),rid:$(newsItem).attr("data-rid")},function(response){var result=response.errNo,data=response.data;if(result=="0"){
var recomDom=_ctx.topDom.find(".c-recommend");if(recomDom){recomDom.remove()}var recomLink="";for(var i=0;i<data.length;i++){recomLink=recomLink+'<a href="'+decodeURIComponent(data[i].recomHref)+'" target="_blank" class="recom-link">'+data[i].recomTitle+"</a>"}var recomNew=""+'<div class="c-recommend">'+'<i class="c-icon"></i>'+'<span class="c-gray">为您推荐：</span>'+recomLink+"</div>";$(newsItem).find(".from").after(recomNew);callback&&callback(newsItem)}else if(result=="501"){}})},
getRecomWords:function(newsItem){var wordsTitle=[],wordNodes=$(newsItem).find(".c-recommend a");for(var i=0;i<wordNodes.length;i++){wordsTitle.push('"'+$.trim($(wordNodes[i]).text())+'"')}return wordsTitle},getEngWords:function(newsItem){var engWords=[],wordNodes=$(newsItem).find(".s-news-content-imgs a");for(var i=0;i<3;i++){engWords.push($.trim($(wordNodes[i]).attr("data-itemId")))}return engWords},getHotWords:function(){var hotWords=[],wordNodes=this.ranDom.find(".title-content");for(
var i=0;i<wordNodes.length;i++){hotWords.push('"'+$.trim($(wordNodes[i]).text())+'"')}return hotWords},waitView:function(e,$dom,banners){var _ctx=this;if(e.type==="mouseenter"){_ctx.ranDom.find(".v-detail").hide();clearTimeout(_ctx.onTimer);clearTimeout(_ctx.offTimer);_ctx.onTimer=setTimeout(function(){$dom.parents(".news-meta-item");_sendHotWordLog()},500)}else if(e.type==="mouseleave"){clearTimeout(_ctx.onTimer);_ctx.hideDetail($dom)}},viewDetail:function($dom,banners){var _title=$.trim($(
".title-content",$dom).html()),_ctx=this;for(var i in banners){if(banners[i].title===_title){banners[i].isNew=0;banners[i].isViewed=1;break}}var holeItemLen=$(".s-news-rank-list .one-item",_ctx.topDom).length;$.ajaxget("/home/news/data/mannewssug?word="+_title,function(response){if(response.data.length<1){return}var top=$dom.offset().top-$(".s-news-rank-content",_ctx.topDom).offset().top+20;var index=parseInt($dom.closest("[data-index]").attr("data-index"));if(index>7){top-=130}if(
$.browser.firefox){top+=10}else if($.isIE==6){top-=3}var tpl=_detailMaker(response.data,top,index>7,+index%2);if(!!tpl){var curDom=$(tpl);$dom.append(curDom);if($.isIE===6){setTimeout(function(){curDom.css({zoom:1})},200)}}})},showDetail:function($dom,banners){var _dDom=$dom.find(".v-detail");$dom.parents(".s-news-rank-content").find(".v-detail").hide();if(_dDom[0]){_dDom.show()}else{this.viewDetail($dom,banners)}return true},hideDetail:function($dom){$dom.find(".v-detail").hide()}}
;function _detailMaker(data,top,down,right){var _tpl=""+'<div class="v-detail#{down}#{right}" style="top:#{top}px;">'+'<div class="detail-content">'+"#{content}"+'<div class="v-arrow">'+"<em></em>"+"</div>"+"</div>"+"</div>";if(!data||!data.length){return false}var _content=_titleMaker(data[0])+_summaryMaker(data[0])+_titleMaker(data[1]);return $.formatString(_tpl,{content:_content,top:top,down:down?" v-down":"",right:right?" v-right":" v-left"})}function _titleMaker(data){if(!data){return""}
data.url=decodeURIComponent(data.url);var _tpl=""+'<div class="hot-words-item">'+'<span class="dot"></span>'+'<a class="word-title" href="#{url}" target="_blank" title="#{realtitle}">'+"#{title}"+"</a>"+"</div>";return $.decodeHTML($.formatString(_tpl,data))}function _summaryMaker(data){var _tpl=""+'<div class="hot-words-summary">'+"#{summary}"+"</div>";return $.decodeHTML($.formatString(_tpl,data))}function _sendHotWordLog(){tool.fire("hotsugClick",{clickType:"layerShow",newsType:"words"})}
return View});
F.addLog("superman:news",{newsShow:"0200100000",recomWordShow:"1100000000",newsClick:"0200100001",hotsugClick:"0200200001",dustbinClick:"page-card-tpl-item",recomWordClick:"page-card-tpl-item",newsBanner:"0200300001",adsNewsFourTimes:"0200300002",adsEngShow:"0200300003",adsEngClick:"0200300004",topNewsImageClick:"0200100002",topNewsTextClick:"0200100003"});F.addLog("superman:news/index",["cardItemLog"]);F.module("superman:news/index",function(require,exports,ctx){var _news_hot;try{
_news_hot=$.parseJSON($("#news_hot_data").text())}catch(e){_news_hot={banner:[]}}var thunder=window.Thunder.get();var _news_adv=$.parseJSON($("#news_banner_data").html());var NView=require("superman:news/index_view");var _topDom=$("#s_xmancard_news_new");var spreadDom=$(".s-news-banner-wrap");var nView=new NView(_topDom);var ck=require("superman:news/ck");var alsLog=require("superman:news/card_alsLog");var _TAB_ID=2;var Tips=require("superman:superuijs/component/tips")
;var ExceedTipsNews=new Tips({target:$("#head"),identity:"ExceedTipsNews",content:"今天召唤我太多次啦，</br>明天再来调教小度吧！`(*∩_∩*)′",timing:2e3,autoShow:false,theme:"exceedtipnews"});var delTipsNews=new Tips({target:$("#head"),content:"已减少同类文章推荐，登录后更精确",identity:"delTipsNews",timing:2e3,hasArrow:false,autoShow:false});var pageNum=0;var ridsArr=[];var aiSampleval=bds&&bds.comm&&bds.comm.aiSampleval;function News(){this.onTimer=null;this.offTimer=null;this.hotRound=1}News.prototype={constructor:News,
init:function(){this.blockName="news";this.addEvent();this.saveFistRids();var wordsStr=this.stringify(nView.getHotWords());ctx.fire("newsShow",{showType:"hotword",words:wordsStr,pagenum:"0"});$(".s-news-rank-wrapper .s-rank-title").addClass("s-opacity-border1-bottom");this.itemNum=$(".s-news-item").length;this.checkEmptyPlaceholderStyle()},checkEmptyPlaceholderStyle:function(){try{var hasStyle=$(".hot-news-wrapper").css("position")==="absolute";var isEmptyStyle=!hasStyle||!$(
"style[data-vue-ssr-id]").html();if(isEmptyStyle){this.reportSpy({stack:"",msg:"pc index node card css is empty!",logId:s_session&&s_session.logId,seqId:s_session&&s_session.seqId,sid:s_session&&s_session.sid})}}catch(e){this.reportSpy(e)}},reportSpy:function(info){var domain=location.protocol==="http:"?"http://sestat.baidu.com/mwb2.gif?":"https://sp1.baidu.com/5b1ZeDe5KgQFm2e88IuM_a/mwb2.gif?";var lid=s_session&&s_session.logId||"";var query=["pid=1_79","lid="+lid,"ts="+Date.now(),"type=except"
,"group=common","info="+encodeURIComponent(JSON.stringify(info))].join("&");var url=domain+query;if(!(navigator.sendBeacon&&navigator.sendBeacon(url))){(new Image).src=url}},stringify:function(arr){return"["+arr.join(",")+"]"},setTopDom:function(topDom){_topDom=topDom},saveFistRids:function(){_topDom.find(".s-news-list-wrapper:first .s-news-item").each(function(){if($(this).attr("data-rid")){ridsArr.push($(this).attr("data-rid"))}else{ridsArr.push("0")}})},getNotNewsPos:function(classname){
var idx=0;_topDom.find(".s-news-item").each(function(i){if($(this).hasClass(classname)){idx=i;return false}});return idx},showLayer:function(noremind,dus){var top,_ctx=this;if($.isIE6){top=$(window).height()/2+$(window).scrollTop()}else{top="50%"}F.use("superman:superuijs/component/dialog",function(Dialog){_ctx.DelPannel=new Dialog({identity:"newsDel",content:'<div class="c-color-t c-font-big">你确定不感兴趣吗？</div><div class="c-font-normal c-color-gray">以后这类信息会少出现的～</div>',hasClose:true,
theme:_ctx.blockName+"-pannel",autoShow:true,width:416,top:top,dus:dus,buttons:[{type:"ok",title:"确认",listener:function(e){_ctx.sendTip(e);if($(dus).hasClass("extends-dustbin")){_ctx.delExtends(dus,1)}else{_ctx.delNew(dus)}ctx.fire("dustbinClick",{nodename:"ok"})}},{type:"cancel",title:"取消",listener:function(){ctx.fire("dustbinClick",{nodename:"cancel"})}}]});if($.isIE===6){$("#sui-dialog-mask").height($(document.body).height())}$(".sui-dialog-close").addClass("c-icon").html("&#xe610;");$(
".sui-dialog-button").addClass("c-btn");$(".sui-dialog-buttonok").addClass("c-btn-primary");$("#sui-dialog-mask").on("click",function(){_ctx.DelPannel.hide()})});$(".sui-dialog-footer").prepend('<a href="javascript:;" onclick="return false;" class="noremind">'+'<span class="c-checkbox">'+'<span class="c-checkbox-inner">'+'<span class="c-icon c-checkbox-inner-bg">&#xe611;</span>'+'<span class="c-icon c-checkbox-inner-i">&#xe61a;</span>'+"</span>"+"</span>不再提示</a>");if(noremind=="1"||noremind=="2"
){$(".c-checkbox").addClass("c-checkbox-checked")}$(".sui-dialog-news-pannel").delegate(".noremind","click",function(e){$(".c-checkbox").toggleClass("c-checkbox-checked");ctx.fire("dustbinClick",{nodename:"noremind"});e.stopPropagation()})},sendTip:function(eve){var $checkBox=eve.target.prev().find(".c-checkbox");var _ctx=this;if($checkBox.hasClass("c-checkbox-checked")){_ctx.setDelrecLayer("1")}else{_ctx.setDelrecLayer("0")}},setDelrecLayer:function(val){$.ajaxpost(
"/home/pcweb/submit/manusertips",{prop:"delrecLayer",value:val},function(data){if(data.errNo==="0"){ctx.fire("setUserAttr",{attr:"delrecLayer",state:"setSucc"})}else{ctx.fire("setUserAttr",{attr:"delrecLayer",state:"setFail"})}})},delNew:function(dustbin){_ctx=this;var parent=$(dustbin).parents(".s-news-item");var grandp=parent.parents(".san-card");var nid=parent.attr("data-nid");if(!nid&&grandp.attr("tpl")==="video"){nid="sv_"+parent.attr("data-rid")}$.ajax({xhrFields:{withCredentials:true},
url:"https://mbd.baidu.com/feedcmp/v1/api/submitpcdislike",type:"POST",dataType:"json",contentType:"text/plain",data:JSON.stringify({nid:nid}),beforeSend:function(xhr){xhr.withCredentials=true},success:function(response){var result=response.errNo;if(result==="0"){var grandParent=parent.parents(".s-news-list-wrapper");_ctx.sendThunderDislike(parent,"click");parent.remove();if(grandParent.children().length===0){grandParent.remove()}_ctx.itemNum--;if(_ctx.itemNum<7){F.call(
"superman:skeleton/presenter","judgeFire")}}else if(+result===501){ExceedTipsNews.show();if($.isIE6){ExceedTipsNews.tips.css({top:$(window).height()/2+$(window).scrollTop()})}else{ExceedTipsNews.tips.css({top:"50%"})}}}})},delNativeAd:function(dustbin){var parent=$(dustbin).parents(".s-news-item");var grandParent=parent.parents(".s-news-list-wrapper");this.sendThunderDislike(parent);parent.remove();if(grandParent.children().length==0){grandParent.remove()}this.itemNum--;if(this.itemNum<7){
F.call("superman:skeleton/presenter","judgeFire")}},sendThunderDislike:function(node,cType){var curNode=$(node),title="",extra={reason:{}};var thunderlog={cst:2,tid:52,logExtra:{rid:curNode.attr("data-rid"),url:curNode.attr("data-url"),clicktype:cType||"",title:title,flow:2,extra:extra,source:[],tag:[],content:[]}};var logCustom=curNode.attr("data-log"),logArr=[];if(logCustom){logCustom=logCustom.replace(/\;$/g,"");logArr=logCustom.split(";");var keyvalue=[];var key="";var value="";for(
var i=0;i<logArr.length;i++){keyvalue=logArr[i].split(":");key=keyvalue[0];value=keyvalue[1];thunderlog.logExtra[key]=value}}thunderlog.logExtra=$.stringify(thunderlog.logExtra);thunderlog.logInfo="l4";thunder.send(thunderlog)},delExtends:function(dustbin,isDelDom){_ctx=this;$.ajaxpost(s_domain.baseuri+"/other/submit/setadstatus",{sortname:"adsNewsFour",aid:$(dustbin).attr("data-aid")},function(response){var result=response.errNo;$.localstorage.remove("adsNewsFourTimes");if(result=="0"&&isDelDom
){var parent=$(dustbin).parents(".s-news-item");var grandParent=parent.parents(".s-news-list-wrapper");_ctx.sendThunderDislike(parent);parent.remove();if(grandParent.children().length==0){grandParent.remove()}_ctx.itemNum--;if(_ctx.itemNum<7){F.call("superman:skeleton/presenter","judgeFire")}ctx.fire("adsNewsFourTimes",{clickType:"close"})}else if(result=="501"){ExceedTipsNews.show();if($.isIE6){ExceedTipsNews.tips.css({top:$(window).height()/2+$(window).scrollTop()})}else{
ExceedTipsNews.tips.css({top:"50%"})}}})},decreaseExtends:function(){var _ctx=this;var dus=_topDom.find(".extends-dustbin");var item=dus.closest(".s-news-item");if(dus.length){ctx.fire("adsNewsFourTimes",{clickType:"show"});var aid=dus.attr("data-aid");if($.localstorage.get("adsNewsFourAid").value!=aid){$.localstorage.remove("adsNewsFourTimes");$.localstorage.set("adsNewsFourAid",aid)}if($.localstorage.get("adsNewsFourTimes").value=="NaN"){$.localstorage.set("adsNewsFourTimes",dus.attr(
"data-times"))}else if($.localstorage.get("adsNewsFourTimes").value){$.localstorage.set("adsNewsFourTimes",parseInt($.localstorage.get("adsNewsFourTimes").value)-1)}else{$.localstorage.set("adsNewsFourTimes",dus.attr("data-times"))}if($.localstorage.get("adsNewsFourTimes").value<="1"){_ctx.delExtends(dus);return}}},addEvent:function(){var _ctx=this;var mainC=$(".s-news-list-wrapper",_topDom);var noInterestTipsNews;_topDom.delegate(".s-news-item","click",function(){var url=$(this).attr("data-url"
);if(url){window.open(url,"_blank")}}).delegate(".s-news-item, .rn-pnews","mouseenter",function(e){if($.isIE===6){$(".dustbin",this).css("display","block")}var _this=this;_ctx.sendThunderDislike(_this,"show");e.stopPropagation()}).delegate(".s-news-item, .rn-pnews","mouseleave",function(e){if($.isIE===6){$(".dustbin",this).css("display","none")}e.stopPropagation()}).delegate(".dustbin","click",function(e){var _this=this;var isLog=s_session.username?1:0;if(isLog===0){var parent=$(_this).parents(
".s-news-item");var grandParent=parent.parents(".s-news-list-wrapper");parent.remove();if(grandParent.children().length==0){grandParent.remove()}_this.itemNum--;if(_this.itemNum<7){F.call("superman:skeleton/presenter","judgeFire")}delTipsNews.tips.show();delTipsNews.tips.css({bottom:"50px",left:"50%",top:"auto",position:"fixed",transform:"translate(-50% , 0)"});setTimeout(function(){delTipsNews.tips.hide()},2e3);return}if($(_this).hasClass("extends-dustbin")){_ctx.delExtends(_this,1)}else{
_ctx.delNew(_this)}noInterestTipsNews&&noInterestTipsNews.close();e.stopPropagation()}).delegate(".dustbin","mouseenter",function(e){_ctxdus=$(this);noInterestTipsNews=new Tips({target:_ctxdus,identity:"noInterestTipsNews",content:"不感兴趣",autoShow:true,arrowUp:false,arrowLeft:"center",align:"center",theme:"nointeresttipnews"});$(".sui-tips-nointeresttipnews").css({top:"+=8"});_ctx.sendThunderDislike(_ctxdus,"show");e.stopPropagation()}).delegate(".dustbin","mouseleave",function(e){
noInterestTipsNews&&noInterestTipsNews.close();e.stopPropagation()}).delegate(".s-news-item a[href]","click",function(e){if(!$(this).attr("data-src")){var newsItem=$(this).parents(".s-news-item");newsItem.addClass("news-viewed");if(s_session.sid.indexOf("18836")>-1&&newsItem.attr("data-relatewords")&&$(this).find(".from")){nView.createRecom(newsItem,function(newsItem){var wordsStr=_ctx.stringify(nView.getRecomWords(newsItem));ctx.fire("recomWordShow",{opType:"recomshow",rid:newsItem.attr(
"data-rid"),words:wordsStr})});_ctx.sendRecomLog(newsItem)}_ctx.handleCRids($(this).parents(".s-news-item").attr("data-rid"))}e.stopPropagation()}).delegate(".s-news-item a[href]","mousedown",function(e){var newsItem=$(this).parents(".s-news-item");var posFromLog=/pos:(\d+);/g.exec(newsItem.attr("data-log"));var posFromRids=ridsArr.indexOf(newsItem.attr("data-rid"));posFromLog=posFromLog&&posFromLog[1]||-1;var pos=posFromRids===-1?posFromLog:posFromRids;if(!$(this).attr("data-src")){if(
!/pos-0/g.test(newsItem.attr("data-log"))){newsItem.attr("data-log",newsItem.attr("data-log")+"pos-0:"+pos+";")}if(newsItem.find(".dustbin").hasClass("extends-dustbin")){var bannerA=newsItem.find(".s-text-content h2 a");ctx.fire("adsNewsFourTimes",{clickType:"click",url:bannerA.attr("href")})}if(newsItem.hasClass("eng-hot-word")){ctx.fire("adsEngClick",{clickType:"click",itemId:$(this).attr("data-itemId")||newsItem.attr("data-itemId"),url:$(this).attr("href"),pos:_ctx.getNotNewsPos(
"eng-hot-word"),subpos:$(this).attr("data-pos"),title:$.trim($(this).find(".s-news-text").text())||$(this).attr("title")})}}else{if(newsItem.hasClass("eng-hot-word")){ctx.fire("adsEngClick",{clickType:"srcClick",url:$(this).attr("href"),pos:_ctx.getNotNewsPos("eng-hot-word"),title:$.trim($(this).text()),itemId:newsItem.attr("data-itemId")})}}}).delegate(".nativead-dustbin","click",function(e){_ctxdus=this;_ctx.delNativeAd(_ctxdus);e.stopPropagation()}).delegate(".s-nativead-item a[href]","click"
,function(e){var adItem=$(this).parents(".s-nativead-item");alsLog.sendAlsClickLog({},{da_locate:+adItem.attr("data-locate"),extra_param:adItem.attr("data-extra-param")})}).delegate(".s-nativead-item a[href]","mousedown",function(e){var adItem=$(this).parents(".s-nativead-item");if(adItem.attr("data-imTimeSign")){ck.saveMousedownInfo(e,adItem.attr("data-imTimeSign"),adItem.attr("data-rid")||"0")}}).delegate(".s-nativead-item a[href]","mouseup",function(e){var adItem=$(this).parents(
".s-nativead-item");if(adItem.attr("data-imTimeSign")){ck.saveMouseupInfo(e,adItem.attr("data-imTimeSign"),adItem.attr("data-rid")||"0")}}).delegate(".s-nativead-item a[href]","mouseover",function(e){var adItem=$(this).parents(".s-nativead-item");if(adItem.attr("data-imTimeSign")){ck.saveMouseoverInfo(e,adItem.attr("data-rid")||"0")}}).delegate(".title-text","click",function(e){ctx.fire("newsClick",{clickType:"hotSearchTitle"})}).delegate(".s-news-rank-wrapper .hot-refresh","click",function(e){
ctx.fire("newsClick",{clickType:"wordsChange"});pageNum++;var wordsStr=_ctx.stringify(nView.getHotWords());ctx.fire("newsShow",{showType:"hotword",words:wordsStr,pagenum:pageNum})}).delegate(".seemore","click",function(e){ctx.fire("newsClick",{clickType:"moreBtnClick"})}).delegate(".news-title .title-link","mouseenter mouseleave",function(e){nView.waitView(e,$(this),_news_hot.banner);e.stopPropagation()}).delegate(".news-title .title-link a","click",function(e){$(this).parents(".news-meta-item"
).removeClass("news-viewed").removeClass("news-artist").addClass("news-viewed");var _title=$.trim($(this).html());$.ajaxpost("/home/news/submit/mannewsview",{title:_title});for(var i in _news_hot.banner){if(_news_hot.banner[i].title==$.decodeHTML($.trim($(this).html()))){_news_hot.banner[i].isViewed=1;_news_hot.banner[i].isNew="0"}}}).delegate(".title-content","click",function(e){var a=$(this);ctx.fire("newsClick",{clickType:"wordTopic",newsType:"words",url:$(this).attr("href"),title:$(this
).text(),pagenum:pageNum,newsindex:$(this).closest(".news-meta-item").attr("data-index")});e.stopPropagation()}).delegate(".word-title","click",function(e){var a=$(this);ctx.fire("hotsugClick",{clickType:"wordTopic",newsType:"words",url:$(this).attr("href")});e.stopPropagation()}).delegate(".title-text a","click",function(e){ctx.fire("hotsugClick",{clickType:"wordTopic",newsType:"topLink",url:$(this).attr("href")})}).delegate("s_news_banner","click",function(e){ctx.fire("hotbannerClick",{
clickType:"",newsType:"topLink",url:$(this).attr("href")})}).delegate(".s-news-banner-wrap","click",function(){ctx.fire("newsBanner",{clickType:"click",url:_news_adv.url,title:_news_adv.title,bannerId:_news_adv.bannerId})}).delegate(".s-text-banner [data-click]","click",function(e){ctx.fire("topNewsTextClick",{clickType:$(this).attr("data-click"),url:$(this).attr("href")||$(this).parent().attr("href")});e.stopPropagation()}).delegate(".s-image-banner [data-click]","click",function(e){ctx.fire(
"topNewsImageClick",{clickType:$(this).attr("data-click"),url:$(this).attr("href")||$(this).parent().attr("href")});e.stopPropagation()});if($.isIE!==6){_ctx.browserFollow()}else{_ctx.ieFollow()}var loaded=false;var loaded2=false;ctx.listen("superman:skeleton/card","cardloaded",function(data){if(data.loadData.rids){for(var i=0;i<data.loadData.rids.length;i++){ridsArr.push(data.loadData.rids[i])}}if(+data.cardId===+_TAB_ID){_topDom.removeClass("s-news-split")}if(data.cardId==_TAB_ID&&!loaded2){
loaded2=true;_ctx.decreaseExtends();if(_topDom.find(".s-news-item.eng-hot-word").length){var lock=true;var engWord=_topDom.find(".s-news-item.eng-hot-word");$(window).on("scroll",function(){if($(window).height()+$(document).scrollTop()>=engWord.offset().top+engWord.height()/2&&lock){setTimeout(function(){var idArr=_ctx.stringify(nView.getEngWords(engWord));if($(engWord).hasClass("eng-word")){ctx.fire("adsEngShow",{showType:"show",pos:_ctx.getNotNewsPos("eng-hot-word"),itemId:idArr})}else{
ctx.fire("adsEngShow",{showType:"show",pos:_ctx.getNotNewsPos("eng-hot-word"),itemId:$(engWord).attr("data-itemId")})}lock=false},100);lock=false}})}}if(data.cardId==_TAB_ID&&nView.perCount!=12&&data.loadData.isEnd=="0"){_ctx.itemNum+=5;if(!loaded){loaded=true;if(_news_adv&&!!+_news_adv.isViewed){var imgurl=$.url.escapeSSL(decodeURIComponent(_news_adv.img));spreadDom.css("background","url("+imgurl+") no-repeat");spreadDom.removeClass("news-banner-hidden");ctx.fire("newsBanner",{clickType:"show",
title:_news_adv.title,bannerId:_news_adv.bannerId})}}var waterpara=_topDom.attr("data-waterpara").split(";");var old_pos=0;for(var i in waterpara){if(!waterpara.hasOwnProperty(i)){continue}var p=waterpara[i].split("=");var k=p[0];var v=p[1];if(k=="pos"){old_pos=parseInt(v)}}_topDom.attr("data-waterpara","version="+data.loadData.version+";"+"pos="+(old_pos+$(data.loadData.html).children().length)+";"+data.loadData.waterpara)}});ctx.listen("superman:superuijs/component/dialog","dialogHide",
function(e){var dus=e.obj.options("dus");if($.isIE===6){var parents=$(dus).parents(".item-wrapper");$(dus).css("display","none");$(".subscribe",parents).css("display","none");$(".img-click",parents).css("display","block")}})},roller:function(tDom,wrapper,out,uTolerance){if(!this.nWrap){this.nWrap=$(".s-news-wrapper",_topDom);this.nOffset=this.nWrap.offset()}var nWrap=this.nWrap;var tOffset=tDom.offset();var tHeight=tDom.height();var mWidth=_topDom.width();var nOffset=this.nOffset
;var ua=navigator.userAgent.toLowerCase();var isPad=ua.match(/iPad/i)&&ua.match(/iPad/i)[0]==="ipad"||navigator.platform==="MacIntel"&&navigator.maxTouchPoints>1;if(aiSampleval){var transform=$("#wrapper").css("transform");if(transform!=="none"){var values=transform.split("(")[1];values=values.split(")")[0];values=values.split(",");var scaleX=parseFloat(values[0]);if(scaleX!==1){return}}if(+$(".s-menu-item.current").data().id!==2){return}if($(document).scrollTop()>tHeight+225&&out&&_topDom.is(
":visible")&&!isPad){wrapper.css({position:"fixed",top:tHeight+66,right:$(window).width()-(nOffset.left+mWidth)+$(window).scrollLeft()})}else{wrapper.removeAttr("style")}return}if(nWrap.offset().top-(tOffset.top+tHeight)<uTolerance+26&&out&&_topDom.is(":visible")&&!isPad){wrapper.css({position:"fixed",top:tHeight+uTolerance,right:$(window).width()-(nOffset.left+mWidth)+$(window).scrollLeft()})}else{wrapper.removeAttr("style")}},browserFollow:function(){var wrapper;if(aiSampleval){wrapper=$(
"#news-special-rank-wrapper")}else{wrapper=$(".s-news-rank-wrapper",_topDom)}var tDom=$("#s_top_wrap");var _ctx=this;var out=false;function Currying(e){if(!wrapper&&aiSampleval){wrapper=$("#news-special-rank-wrapper")}_ctx.roller(tDom,wrapper,out,66)}ctx.listen("superman:page/scroll","outMenu",function(data){if(data.out===true){out=true;$(window).bind("scroll",Currying);$(window).bind("resize",Currying)}else{out=false;$(window).unbind("scroll",Currying);$(window).unbind("resize",Currying);if(
aiSampleval){if(+$(".s-menu-item.current").data().id===2){wrapper.removeAttr("style")}}else{wrapper.removeAttr("style")}}});$(window).bind("resize",function(){if(!_ctx.nWrap){_ctx.nWrap=$(".s-news-wrapper",_topDom)}_ctx.nOffset=_ctx.nWrap.offset()});ctx.listen("superman:skeleton/presenter","switchCard",function(data){$(window).trigger("switchCard");if(+data.toCard===_TAB_ID){if(!_ctx.nWrap){_ctx.nWrap=$(".s-news-wrapper",_topDom)}_ctx.nOffset=_ctx.nWrap.offset()}})},ieFollow:function(){
var wrapper=$(".s-news-rank-wrapper",_topDom);var $sCnt=$("#s_ctner_contents");var preTop=0;var wHeight=wrapper.height();function roller(){if($(this).scrollTop()>preTop){_top=Math.min(Math.max($(this).scrollTop()-322,0),Math.abs($sCnt.height()-wHeight-100))}else{_top=Math.min(Math.max($(this).scrollTop()-290,0),Math.abs($sCnt.height()-wHeight-100))}wrapper.stop().animate({top:_top});preTop=$(this).scrollTop()}$(window).bind("scroll",roller)},sendRecomLog:function(newsItem){var _ctx=this
;var timer;newsItem.delegate(".recom-link","click",function(e){$(this).css("color","#666");var wordsStr=_ctx.stringify(nView.getRecomWords(newsItem));ctx.fire("recomWordClick",{nodename:"recomLink",url:$(this).attr("href")||"",title:$.trim($(this).text())||"",rid:newsItem.attr("data-rid"),words:wordsStr});e.stopPropagation()}).delegate(".recom-link","mouseenter",function(e){var ctxrecom=this;timer=setTimeout(function(){var wordsStr=_ctx.stringify(nView.getRecomWords(newsItem));ctx.fire(
"recomWordShow",{onType:"hover",url:$(ctxrecom).attr("href")||"",title:$.trim($(ctxrecom).text())||"",rid:newsItem.attr("data-rid"),words:wordsStr})},500);e.stopPropagation()}).delegate(".recom-link","mouseleave",function(e){clearTimeout(timer)})},handleCRids:function(rid){var storedClickRids=window.s_session.crids||(window.s_session.crids="");if(!!rid){var cridsArr=[];!!storedClickRids&&(cridsArr=storedClickRids.split(","));cridsArr.indexOf(rid)===-1||cridsArr.splice(cridsArr.indexOf(rid),1)
;cridsArr.unshift(rid);cridsArr.length>10&&(cridsArr.length=10);var cridsStr=cridsArr.join();window.s_session.crids=cridsStr}}};return new News});F.use("superman:news/index",function(news){news.init()});